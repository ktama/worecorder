# 📝 作業時間記録アプリ 仕様書 v2.0

## 1. アプリ概要

個人利用を想定した、**ローカル環境で完結する作業時間記録アプリ**。開始/終了ボタンによる直感的な記録と、編集のしやすさを両立し、日ごとの作業レポートを確認・集計できる。

---

## 2. 想定利用環境

| 項目             | 内容                                           |
| ---------------- | ---------------------------------------------- |
| 対象ユーザー     | 個人ユーザー                                   |
| プラットフォーム | デスクトップアプリ（Tauri）                    |
| フロントエンド   | React + TypeScript                             |
| バックエンド     | Rust（Tauriバックエンド）                      |
| ネットワーク     | 外部ネットワーク接続不要（ローカルのみで動作） |
| データ保存       | ローカルJSONファイル保存（パス設定可能）       |
| ユーザー管理     | 不要（ログイン不要）                           |

---

## 3. 主な機能

### ✅ 時間記録

* **開始／終了ボタン**によるタイマー形式
* 作業中に新しい記録を開始すると、直前の作業は自動で終了
* **手動編集**：開始／終了時刻、作業内容などを後から編集可能
* **削除機能**：記録の削除が可能（確認ダイアログ付き）

### ✅ 記録項目

| 項目名               | 詳細                                                                                     |
| -------------------- | ---------------------------------------------------------------------------------------- |
| プロジェクト管理番号 | ユーザーが任意に設定可能（英数字）                                                       |
| プロジェクト名       | 管理番号と1対1対応（管理番号入力時に既存プロジェクト名を自動補完、新規の場合は同時入力） |
| 作業カテゴリ         | 事前定義カテゴリ + 過去入力履歴からの候補表示                                            |
| 作業内容             | 自由入力（テキストエリア）                                                               |
| 開始時刻             | 自動取得または手動編集（日時ピッカー）                                                   |
| 終了時刻             | 自動取得または手動編集（日時ピッカー）                                                   |
| 作業時間             | 自動計算（分単位）                                                                       |

---

## 4. プロジェクト管理機能

### 📋 プロジェクト管理

* **自動補完機能**：管理番号入力時に既存プロジェクト名を自動補完
* **新規プロジェクト作成**：管理番号とプロジェクト名を同時入力
* **プロジェクト一覧表示**：登録済みプロジェクトの確認・編集
* **プロジェクト削除**：不要なプロジェクトの削除
* **検索機能**：プロジェクト名・管理番号での検索

### 🏷️ 作業カテゴリ管理

* **事前定義カテゴリ**：
  - 開発
  - 会議
  - 調査
  - 設計
  - テスト
  - ドキュメント作成
  - レビュー
  - その他
* **過去入力履歴**：過去に使用したカテゴリを候補として表示
* **カスタムカテゴリ**：フリーワード入力でカテゴリ追加
* **カテゴリ管理**：事前定義カテゴリの追加・削除・編集

---

## 5. レポート・分析機能

### 📊 日別集計画面

* **日付選択**：カレンダーピッカーで任意の日付を選択
* **集計表示**：プロジェクト管理番号 × 作業カテゴリごとの合計時間を表示
* **作業内容の内訳表示**：同名作業を合計し、以下の形式で表示
  ```
  作業内容A（合計時間）、作業内容B（合計時間）
  例：仕様検討(2時間30分)、実装(4時間)
  ```
* **時間表示形式**：時間:分 または 分単位での表示切り替え
* **データ視覚化**：棒グラフ、円グラフでの表示
* **期間集計**：日別、週別、月別の集計表示

### 📈 レポート詳細

* **プロジェクト別集計**：プロジェクトごとの作業時間集計
* **カテゴリ別集計**：作業カテゴリごとの時間分析
* **作業効率分析**：時間帯別の作業パターン分析
* **エクスポート機能**：CSVファイルでのデータ出力

---

## 6. 保存・データ管理

### 💾 データ保存

* **保存形式**：JSON形式でのローカルファイル保存
* **保存先設定**：ユーザーが任意のディレクトリを設定可能
* **自動保存**：設定可能な間隔での自動保存
* **バックアップ機能**：データの手動バックアップ・復元

### 📁 ファイル構成

```
{データディレクトリ}/
├── projects.json          # プロジェクト情報
├── categories.json        # カテゴリ情報
├── work_records.json      # 作業記録
├── settings.json          # アプリケーション設定
└── backups/              # バックアップフォルダ
    ├── backup_YYYYMMDD_HHMMSS.json
    └── ...
```

---

## 7. UI/UX機能

### 🎨 インターフェース

* **テーマ切り替え**：ダークモード/ライトモードの切り替え
* **レスポンシブデザイン**：ウィンドウサイズに応じたレイアウト調整
* **キーボードショートカット**：主要機能へのショートカット
* **通知機能**：作業開始/終了時の通知表示
* **ローディング状態**：処理中の視覚的フィードバック

### ⚙️ 設定機能

* **保存先設定**：データ保存ディレクトリの変更
* **時間表示形式**：HH:mm または 分単位での表示切り替え
* **テーマ設定**：ダーク/ライトモードの選択
* **自動保存間隔**：自動保存の頻度設定
* **デフォルトカテゴリ**：事前定義カテゴリの管理
* **通知設定**：通知の有効/無効切り替え

---

## 8. 技術構成

### 🔧 技術スタック

| 構成要素       | 技術                       |
| -------------- | -------------------------- |
| デスクトップ   | Tauri                      |
| フロントエンド | React + TypeScript         |
| バックエンド   | Rust                       |
| UI ライブラリ  | Material-UI / Tailwind CSS |
| 状態管理       | React Hooks / Context      |
| データ形式     | JSON                       |
| ビルドツール   | Vite                       |

### 🗂️ データモデル

```rust
// 作業記録
struct WorkRecord {
    id: String,
    project_id: String,
    project_name: String,
    category: String,
    content: String,
    start_time: DateTime<Local>,
    end_time: Option<DateTime<Local>>,
    duration: i32, // 分単位
}

// プロジェクト
struct Project {
    id: String,
    name: String,
    created_at: DateTime<Local>,
    updated_at: DateTime<Local>,
}

// 設定
struct AppSettings {
    data_directory: String,
    time_format: String, // "HH:mm" or "minutes"
    theme: String, // "light" or "dark"
    auto_save_interval: i32,
    show_notifications: bool,
}
```

---

## 9. セキュリティ・パフォーマンス

### 🔒 セキュリティ

* **ローカルデータ保護**：ファイル権限の適切な設定
* **入力検証**：SQLインジェクション等の対策
* **エラーハンドリング**：適切なエラーメッセージ表示

### ⚡ パフォーマンス

* **メモリ効率**：大量データの効率的な処理
* **ファイルI/O最適化**：高速なデータ読み書き
* **UI応答性**：スムーズなユーザーインタラクション

---

## 10. 開発・テスト方針

### 🧪 テスト戦略

* **ユニットテスト**：Rust関数の個別テスト
* **コンポーネントテスト**：React コンポーネントのテスト
* **統合テスト**：フロントエンド・バックエンド間のAPI テスト
* **エラーケーステスト**：異常系処理のテスト

### 📋 品質保証

* **コードレビュー**：可読性・保守性の確保
* **静的解析**：ESLint, Clippy による コード品質チェック
* **パフォーマンステスト**：レスポンス速度の測定

---

## 11. 将来的な拡張候補（今回の対象外）

* **クラウド連携**：Google Drive、Dropbox等との同期
* **複数端末同期**：データの端末間同期
* **リマインド機能**：作業開始・終了のリマインダー
* **ポモドーロ連携**：ポモドーロテクニックとの統合
* **レポート機能拡張**：より詳細な分析レポート
* **チーム機能**：複数人での作業時間共有
* **API連携**：外部ツールとの連携機能

---

## 12. 開発マイルストーン

### Phase 1: 基本機能実装
- Tauriプロジェクト設定
- データモデル・ファイル保存
- 基本的な作業記録機能

### Phase 2: 主要機能実装
- プロジェクト管理・自動補完
- カテゴリ管理
- 日別集計・レポート

### Phase 3: UI/UX改善
- 設定機能
- テーマ切り替え
- 通知機能

### Phase 4: 品質向上
- テスト実装
- バグ修正
- パフォーマンス最適化

---

## 13. 成功指標

* **基本機能**：タイマー開始/終了、手動編集が正常に動作
* **データ整合性**：データの保存・読み込みが確実に動作
* **ユーザビリティ**：直感的な操作で作業記録が可能
* **パフォーマンス**：1000件以上の記録でも快適に動作
* **安定性**：長時間使用でもメモリリークやクラッシュが発生しない

---

*最終更新日: 2025年7月13日*
*バージョン: 2.0*